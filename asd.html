<script>
  const urlParams = new URLSearchParams(window.location.search);
  const setDataLayer = (event, action, value) => {
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      step_count: "us1", //lp, us1, us2, us3, ds1, ty
      page_id: "BSH-FP-OMO", //OG-LP-OMO, pegar pelo query da url, passar pra frente.
      version_id: "v1", //v1-control, v2-dropdown, v2-modal
      event: event, //offer_view, interaction
      action: action, //purchase, purchase-us, click, view_page
      value: value, //final purchase value
      transaction_id: urlParams.get('order_uuid'),
    });
  };
  const dataLayerStart = () => {
    setDataLayer((event = "pageview"), (action = "load"), (value = 0));
  };

  const dataLayerRedirect = () => {
    setDataLayer((event = "offerview"), (action = "viewaction"), (value = 0));
  };

  const dataLayerNoThanks = () => {
    setDataLayer((event = "interection"), (action = "click"), (value = 0));
  };
  window.onload = function () {
    const ids_1 = ['element-61'];
    const ids_2 = ['element-59'];
    const ids_3 = ['element-60'];
    const ids_4 = ['element-45'];

    urlParams.delete("step_count");
    urlParams.delete("step_code");
    urlParams.delete("from");
    urlParams.delete("to");
    urlParams.delete("product1");
    urlParams.delete("product0");
    const origin = (window.location.pathname).replace("/", "").replace("/", "");
    document.cookie = "offer_id=" + origin + "; path=/; domain=.buckedup.com;max-age=3600";

    //Pageview data layer
    dataLayerStart();

    // Adicionando event listener para ids_1
    ids_1.forEach(id => {
      const button = document.getElementById(id);

      if (button) {
        button.addEventListener('click', function handleClick(event) {
          // Ação data layer para ids_1
          dataLayerRedirect();

          const venda = urlParams.get('order_uuid');
          window.location.href = "https://select.buckedup.com/modal?time=001&discount=&open=&product0=978&order_uuid=" + venda + "&to=bshus2&from=" + origin + "&step_code=us1_sel&step=1&source=instapage";
        });
      }
    });

    // Adicionando event listener para ids_2
    ids_2.forEach(id => {
      const button = document.getElementById(id);

      if (button) {
        button.addEventListener('click', function handleClick(event) {
          // Ação data layer para ids_2
          dataLayerRedirect()

          const venda_2 = urlParams.get('order_uuid');
          window.location.href = "https://select.buckedup.com/multipleUpsell?time=001&discount=&open=&product0=1007&order_uuid=" + venda_2 + "&to=bshus2&from=" + origin + "&step_code=us1_sel&step=1&source=instapage";
        });
      }
    });

    // Adicionando event listener para ids_3
    ids_3.forEach(id => {
      const button = document.getElementById(id);

      if (button) {
        button.addEventListener('click', function handleClick(event) {
          // Ação data layer para ids_3
          dataLayerRedirect()

          const venda_3 = urlParams.get('order_uuid');
          window.location.href = "https://select.buckedup.com/multipleUpsell?time=001&discount=&open=&product0=1008&order_uuid=" + venda_3 + "&to=bshus2&from=" + origin + "&step_code=us1_sel&step=1&source=instapage";
        });
      }
    });

    // Adicionando event listener para ids_4
    ids_4.forEach(id => {
      const button = document.getElementById(id);

      if (button) {
        button.addEventListener('click', function handleClick(event) {
          // Ação data layer para ids_4
          dataLayerNoThanks();

          const venda_4 = urlParams.get('order_uuid');
          window.location.href = "https://get.buckedup.com/bshds2?order_uuid=" + venda_4;
        });
      }
    });
  }
</script>